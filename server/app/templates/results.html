<html>
   <head>
      <title>Google Charts Tutorial</title>
      <script type = "text/javascript" src = "https://www.gstatic.com/charts/loader.js">
      </script>
      <script type = "text/javascript">
         google.charts.load('current', {packages: ['corechart']});     
      </script>
   </head>
   
   <body>
      <div id = "container" style = "width: 550px; height: 400px; margin: 0 auto">
      </div>
      <script language = "JavaScript">
		var url = '/results/test'; //A local page
		var jsonData = "temp";

		function load(url, callback) {
			var xhr = new XMLHttpRequest();

			xhr.onreadystatechange = function() {
				if (xhr.readyState === 4) {
				  callback(xhr.response);
				}
			}

			xhr.open('GET', url, true);
			xhr.send('');
		}

		function drawChart() {
			// Define the chart to be drawn.
			var data = new google.visualization.DataTable();
			data.addColumn('number', 'ID');
			data.addColumn('number', 'Percentage Difference');
			data.addRows(window.value);
			   
			// Set chart options
			var options = {
			   'title':'Percentage Difference',
			   'width':550,
			   'height':400,
			   'legend': 'none'
			};

			// Instantiate and draw the chart.
			var chart = new google.visualization.ScatterChart(document.getElementById('container'));
			chart.draw(data, options);
		}

		const request = async () => {
			const response = await fetch('/results/data');
			const json = await response.json();
			window.value = json;
			google.charts.setOnLoadCallback(drawChart);
		}

		request();

      </script>
   </body>
</html>
