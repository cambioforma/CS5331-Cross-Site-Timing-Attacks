<html>
   <head>
      <title>Google Charts Tutorial</title>
      <script type = "text/javascript" src = "https://www.gstatic.com/charts/loader.js">
      </script>
      <script type = "text/javascript">
         google.charts.load('current', {packages: ['corechart']});     
      </script>
   </head>
   <body>
		<div id = "scatterplot" style = "width: 550px; height: 400px; margin: 0 auto"></div>
		 <select id = "threshold" name="Percentage Threshold:" onchange="changeURL()">
			<option value="0">0</option>
			<option value="10">10</option>
			<option value="20">20</option>
			<option value="30">30</option>
			<option value="40">40</option>
			<option value="50">50</option>
			<option value="60">60</option>
			<option value="70">70</option>
			<option value="80">80</option>
			<option value="90">90</option>
		</select>
		<div id = "barchart" style = "width: 550px; height: 400px; margin: 0 auto"></div>
   </body>
	<script language = "JavaScript">
		var url = '/results/0'; //A local page
		var jsonData = "temp";

		function changeURL() {
			var e = document.getElementById("threshold");
			url = 'results/' + e.options[e.selectedIndex].value;
			request();
		}

		function drawScatterChart() {
			// Define the chart to be drawn.
			var data = new google.visualization.DataTable();
			data.addColumn('number', 'ID');
			data.addColumn('number', 'Percentage Difference');
			data.addRows(window.value);
			   
			// Set chart options
			var options = {
			   'title':'Percentage Difference',
			   'width':550,
			   'height':400,
			   'legend': 'none'
			};

			// Instantiate and draw the chart.
			var chart = new google.visualization.ScatterChart(document.getElementById('scatterplot'));
			chart.draw(data, options);
		}

		const request = async () => {
			const response = await fetch(url);
			const json = await response.json();
			window.value = json;
			google.charts.setOnLoadCallback(drawScatterChart);
			google.charts.setOnLoadCallback(drawBarChart);
		}

         function drawBarChart() {
            // Define the chart to be drawn.
            var data = google.visualization.arrayToDataTable([
               ['Year', 'Yes', 'No'],
               ['2012',  900,      390],
               ['2013',  1000,      400],
               ['2014',  1170,      440],
               ['2015',  1250,       480],
               ['2016',  1530,      540]
            ]);

            var options = {title: 'Websites Visited:', isStacked:true};  

            // Instantiate and draw the chart.
            var chart = new google.visualization.BarChart(document.getElementById('barchart'));
            chart.draw(data, options);
         }

		request();
	</script>
</html>
